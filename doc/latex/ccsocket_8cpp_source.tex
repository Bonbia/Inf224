\doxysection{ccsocket.\+cpp}
\hypertarget{ccsocket_8cpp_source}{}\label{ccsocket_8cpp_source}\index{ccsocket.cpp@{ccsocket.cpp}}
\mbox{\hyperlink{ccsocket_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00001}00001\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00002}00002\ \textcolor{comment}{//\ \ ccsocket:\ C++\ Classes\ for\ TCP/IP\ and\ UDP\ Datagram\ INET\ Sockets.}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00003}00003\ \textcolor{comment}{//\ \ (c)\ Eric\ Lecolinet\ 2016/2020\ -\/\ http://www.telecom-\/paristech.fr/\string~elc}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00004}00004\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ <cstdlib>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <winsock2.h>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <ws2tcpip.h>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#pragma\ comment(lib,\ "{}ws2\_32.lib"{})}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00014}00014\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00015}00015\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \ \ \ \ \ \textcolor{comment}{//\ fcntl.h\ \ won't\ compile\ without\ unistd.h\ !}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00016}00016\ \textcolor{preprocessor}{\#include\ <netinet/tcp.h>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00017}00017\ \textcolor{preprocessor}{\#include\ <netdb.h>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00018}00018\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00019}00019\ \textcolor{preprocessor}{\#include\ <fcntl.h>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00020}00020\ \textcolor{preprocessor}{\#include\ <csignal>}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00021}00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ccsocket_8h}{ccsocket.h}}"{}}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00023}00023\ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00025}\mbox{\hyperlink{classSocket_a1a662407744738aa56d1ccb6d7be26eb}{00025}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSocket_a1a662407744738aa56d1ccb6d7be26eb}{Socket::startup}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00026}00026\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00027}00027\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ started\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00028}00028\ \ \ \textcolor{keyword}{static}\ WSADATA\ WSAData;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00029}00029\ \ \ \textcolor{keywordflow}{if}\ (!started)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00030}00030\ \ \ \ \ started\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00031}00031\ \ \ \ \ WSAStartup(MAKEWORD(2,\ 0),\ \&WSAData);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00032}00032\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00033}00033\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00034}00034\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00037}\mbox{\hyperlink{classSocket_a744a91706b9510d266b7c07e31f3e028}{00037}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSocket_a744a91706b9510d266b7c07e31f3e028}{Socket::cleanup}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00038}00038\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00039}00039\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ started\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00040}00040\ \ \ \textcolor{keywordflow}{if}\ (!started)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00041}00041\ \ \ \ \ started\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00042}00042\ \ \ \ \ WSACleanup();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00043}00043\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00044}00044\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00045}00045\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00048}\mbox{\hyperlink{classSocket_acd3cb39bc957be2f34c91b9e262e1cec}{00048}}\ \mbox{\hyperlink{classSocket_acd3cb39bc957be2f34c91b9e262e1cec}{Socket::Socket}}(\textcolor{keywordtype}{int}\ type)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00049}00049\ \ \ \mbox{\hyperlink{classSocket_a1a662407744738aa56d1ccb6d7be26eb}{startup}}();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00051}00051\ \ \ \textcolor{comment}{//\ family\ is\ AF\_INET\ (AF\_UNIX\ or\ AF\_INET6\ not\ supported)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00052}00052\ \ \ \textcolor{comment}{//\ type\ can\ be\ SOCK\_STREAM\ (TCP/IP)\ or\ SOCK\_DGRAM\ (datagram\ connection)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00053}00053\ \ \ \textcolor{comment}{//\ protocol\ is\ 0\ (ie\ chosen\ automatically)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00054}00054\ \ \ \mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}}\ =\ ::socket(AF\_INET,\ type,\ 0);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00056}00056\ \ \ \textcolor{comment}{//\ ignore\ SIGPIPES\ when\ possible}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00057}00057\ \textcolor{preprocessor}{\#if\ defined(SO\_NOSIGPIPE)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00058}00058\ \ \ \textcolor{keywordtype}{int}\ set\ =\ 1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00059}00059\ \ \ setsockopt(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ SOL\_SOCKET,\ SO\_NOSIGPIPE,\ (\textcolor{keywordtype}{void}*)\&set,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00060}00060\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00061}00061\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00064}\mbox{\hyperlink{classSocket_a8e3f095dfe84d6599761c4ca54900487}{00064}}\ \mbox{\hyperlink{classSocket_acd3cb39bc957be2f34c91b9e262e1cec}{Socket::Socket}}(\textcolor{keywordtype}{int},\ \mbox{\hyperlink{ccsocket_8h_aff55fe551a9992a54ec54621c524d0a4}{SOCKET}}\ sockfd)\ :\ sockfd\_(sockfd)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00065}00065\ \ \ \mbox{\hyperlink{classSocket_a1a662407744738aa56d1ccb6d7be26eb}{startup}}();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00066}00066\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00068}\mbox{\hyperlink{classSocket_aeac4eb6379a543d38ed88977d3b6630a}{00068}}\ \mbox{\hyperlink{classSocket_aeac4eb6379a543d38ed88977d3b6630a}{Socket::\string~Socket}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00069}00069\ \ \ \mbox{\hyperlink{classSocket_aef06605c6725958004116983f1a2051f}{close}}();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00070}00070\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00073}00073\ \textcolor{comment}{//\ for\ INET4\ sockets}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00074}\mbox{\hyperlink{classSocket_ae65efac394eb49594cbb5b2db957e056}{00074}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_ae65efac394eb49594cbb5b2db957e056}{Socket::setLocalAddress}}(\mbox{\hyperlink{ccsocket_8h_a91d11a5e66bd1e10b0e62aadb7775c9d}{SOCKADDR\_IN}}\&\ addr,\ \textcolor{keywordtype}{int}\ port)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00075}00075\ \ \ addr\ =\ \{\};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00076}00076\ \ \ addr.sin\_family\ =\ AF\_INET;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00077}00077\ \ \ addr.sin\_port\ =\ htons(port);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00078}00078\ \ \ addr.sin\_addr.s\_addr\ =\ htonl(INADDR\_ANY);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00079}00079\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00080}00080\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00083}00083\ \textcolor{comment}{//\ for\ INET4\ sockets}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00084}\mbox{\hyperlink{classSocket_afa64e345564506760728d2b545fcbe0c}{00084}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_afa64e345564506760728d2b545fcbe0c}{Socket::setAddress}}(\mbox{\hyperlink{ccsocket_8h_a91d11a5e66bd1e10b0e62aadb7775c9d}{SOCKADDR\_IN}}\&\ addr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\&\ host,\ \textcolor{keywordtype}{int}\ port)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00085}00085\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00086}00086\ \ \ addr\ =\ \{\};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00087}00087\ \ \ addr.sin\_family\ =\ AF\_INET;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00088}00088\ \ \ addr.sin\_port\ =\ htons(port);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00089}00089\ \ \ inet\_pton(AF\_INET,\ host.data(),\ \&addr.sin\_addr.s\_addr);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00090}00090\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00091}00091\ \ \ addr\ =\ \{\};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00092}00092\ \ \ \textcolor{keyword}{struct\ }hostent*\ hent\ =\ NULL;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00093}00093\ \ \ \textcolor{comment}{//\ gethostbyname()\ is\ obsolete!}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00094}00094\ \ \ \textcolor{keywordflow}{if}\ (host.empty()\ ||\ !(hent\ =\ ::gethostbyname(host.c\_str())))\ \textcolor{keywordflow}{return}\ -\/1;\ \textcolor{comment}{//\ host\ not\ found}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00095}00095\ \ \ addr.sin\_family\ =\ AF\_INET;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00096}00096\ \ \ addr.sin\_port\ =\ htons(port);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00097}00097\ \ \ \textcolor{comment}{//\ NB:\ data\ might\ be\ misaligned\ but\ correct\ result\ because\ memcpy()\ is\ used}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00098}00098\ \ \ ::memcpy(\&addr.sin\_addr,\ hent-\/>h\_addr\_list[0],\ hent-\/>h\_length);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00099}00099\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00100}00100\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00101}00101\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00104}\mbox{\hyperlink{classSocket_aff8a77c02a44937db59c8c8a057072d9}{00104}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_aff8a77c02a44937db59c8c8a057072d9}{Socket::bind}}(\textcolor{keywordtype}{int}\ port)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00105}00105\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}}\ ==\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00106}00106\ \ \ \textcolor{comment}{//\ for\ INET4\ sockets}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00107}00107\ \ \ \mbox{\hyperlink{ccsocket_8h_a91d11a5e66bd1e10b0e62aadb7775c9d}{SOCKADDR\_IN}}\ addr;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00108}00108\ \ \ \mbox{\hyperlink{classSocket_ae65efac394eb49594cbb5b2db957e056}{setLocalAddress}}(addr,\ port);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00109}00109\ \ \ \textcolor{comment}{//\ assigns\ the\ address\ specified\ by\ addr\ to\ sockfd\ (returns\ -\/1\ on\ error,\ 0\ otherwise)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00110}00110\ \ \ return\ ::bind(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{ccsocket_8h_a964e73b2a42e87b1e20c8ffa730952a2}{SOCKADDR}}*)\&addr,\ \textcolor{keyword}{sizeof}(addr));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00111}00111\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00113}00113\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00114}00114\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_aff8a77c02a44937db59c8c8a057072d9}{Socket::bind}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\&\ host,\ \textcolor{keywordtype}{int}\ port)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00115}00115\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}}\ ==\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00116}00116\ \ \ \textcolor{comment}{//\ for\ INET4\ sockets}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00117}00117\ \ \ \mbox{\hyperlink{ccsocket_8h_a91d11a5e66bd1e10b0e62aadb7775c9d}{SOCKADDR\_IN}}\ addr;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00118}00118\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocket_afa64e345564506760728d2b545fcbe0c}{setAddress}}(addr,\ host,\ port)\ <\ 0)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ab8eb7f6e1d237e242921ef128c01491c}{UnknownHost}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00119}00119\ \ \ \textcolor{comment}{//\ assigns\ the\ address\ specified\ by\ addr\ to\ sockfd\ (returns\ -\/1\ on\ error,\ 0\ otherwise)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00120}00120\ \ \ return\ ::bind(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{ccsocket_8h_a964e73b2a42e87b1e20c8ffa730952a2}{SOCKADDR}}*)\&addr,\ \textcolor{keyword}{sizeof}(addr));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00121}00121\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00124}\mbox{\hyperlink{classSocket_a772419bd74c4fe4987d190506a64ff87}{00124}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_a772419bd74c4fe4987d190506a64ff87}{Socket::connect}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\&\ host,\ \textcolor{keywordtype}{int}\ port)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00125}00125\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}}\ ==\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00126}00126\ \ \ \textcolor{comment}{//\ for\ INET4\ sockets}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00127}00127\ \ \ \mbox{\hyperlink{ccsocket_8h_a91d11a5e66bd1e10b0e62aadb7775c9d}{SOCKADDR\_IN}}\ addr;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00128}00128\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocket_afa64e345564506760728d2b545fcbe0c}{setAddress}}(addr,\ host,\ port)\ <\ 0)\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ab8eb7f6e1d237e242921ef128c01491c}{UnknownHost}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00129}00129\ \ \ \textcolor{comment}{//\ connects\ sockfd\ to\ the\ address\ specified\ by\ addr\ (returns\ -\/1\ on\ error,\ 0\ otherwise)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00130}00130\ \ \ return\ ::connect(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ (\mbox{\hyperlink{ccsocket_8h_a964e73b2a42e87b1e20c8ffa730952a2}{SOCKADDR}}*)\&addr,\ \textcolor{keyword}{sizeof}(addr));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00131}00131\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00134}\mbox{\hyperlink{classSocket_aef06605c6725958004116983f1a2051f}{00134}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_aef06605c6725958004116983f1a2051f}{Socket::close}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00135}00135\ \ \ \textcolor{keywordtype}{int}\ stat\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00136}00136\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}}\ !=\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00137}00137\ \ \ \ \ stat\ =\ ::shutdown(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ 2);\ \ \textcolor{comment}{//\ SHUT\_RDWR=2}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00138}00138\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00139}00139\ \ \ \ \ stat\ +=\ ::closesocket(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00140}00140\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00141}00141\ \ \ \ \ stat\ +=\ \mbox{\hyperlink{classSocket_aef06605c6725958004116983f1a2051f}{::close}}(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00142}00142\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00143}00143\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00144}00144\ \ \ \mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}}\ =\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00145}00145\ \ \ \textcolor{keywordflow}{return}\ stat;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00146}00146\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00149}\mbox{\hyperlink{classSocket_a417b47af24de10184192de00d9112589}{00149}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSocket_a417b47af24de10184192de00d9112589}{Socket::shutdownInput}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00150}00150\ \ \ ::shutdown(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ 0);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00151}00151\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00153}\mbox{\hyperlink{classSocket_a650128aee2581e6695c6812d8afe14b5}{00153}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSocket_a650128aee2581e6695c6812d8afe14b5}{Socket::shutdownOutput}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00154}00154\ \ \ ::shutdown(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ 1\textcolor{comment}{/*SD\_SEND*/});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00155}00155\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00157}00157\ \textcolor{preprocessor}{\#if\ !defined(\_WIN32)\ \&\&\ !defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00159}\mbox{\hyperlink{classSocket_a06ff0dd6837c9f51948df655fc2713cd}{00159}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_a06ff0dd6837c9f51948df655fc2713cd}{Socket::setReceiveBufferSize}}(\textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00160}00160\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ SOL\_SOCKET,\ SO\_RCVBUF,\ \&size,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00161}00161\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00163}\mbox{\hyperlink{classSocket_afc49ad6cc259a0006ca13bb22fdd7383}{00163}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_afc49ad6cc259a0006ca13bb22fdd7383}{Socket::setSendBufferSize}}(\textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00164}00164\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ SOL\_SOCKET,\ SO\_SNDBUF,\ \&size,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00165}00165\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00167}\mbox{\hyperlink{classSocket_ab02b997fa7e251d596116e95c9ccaf97}{00167}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_ab02b997fa7e251d596116e95c9ccaf97}{Socket::setReuseAddress}}(\textcolor{keywordtype}{bool}\ state)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00168}00168\ \ \ \textcolor{keywordtype}{int}\ set\ =\ state;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00169}00169\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ SOL\_SOCKET,\ SO\_REUSEADDR,\ \&set,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00170}00170\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00172}\mbox{\hyperlink{classSocket_a41cc1caae51e3e83e16ce2c20689ed03}{00172}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_a41cc1caae51e3e83e16ce2c20689ed03}{Socket::setSoLinger}}(\textcolor{keywordtype}{bool}\ on,\ \textcolor{keywordtype}{int}\ time)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00173}00173\ \ \ \textcolor{keyword}{struct\ }linger\ l;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00174}00174\ \ \ l.l\_onoff\ =\ on;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Linger\ active}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00175}00175\ \ \ l.l\_linger\ =\ time;\ \ \ \ \ \ \ \textcolor{comment}{//\ How\ long\ to\ linger\ for}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00176}00176\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ SOL\_SOCKET,\ SO\_LINGER,\ \&l,\ \textcolor{keyword}{sizeof}(l));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00177}00177\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00179}\mbox{\hyperlink{classSocket_ad65a22ec40902e2c0a98c5d4ac885f99}{00179}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_ad65a22ec40902e2c0a98c5d4ac885f99}{Socket::setSoTimeout}}(\textcolor{keywordtype}{int}\ timeout)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00180}00180\ \ \ \textcolor{keyword}{struct\ }timeval\ tv;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00181}00181\ \ \ tv.tv\_sec\ =\ timeout\ /\ 1000;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ms\ to\ seconds}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00182}00182\ \ \ tv.tv\_usec\ =\ (timeout\ \%\ 1000)\ *\ 1000;\ \ \ \textcolor{comment}{//\ ms\ to\ microseconds}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00183}00183\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ SOL\_SOCKET,\ SO\_RCVTIMEO,\ \&tv,\ \textcolor{keyword}{sizeof}(tv));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00184}00184\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00186}\mbox{\hyperlink{classSocket_a7bc0110f3bedbb18f26b05ece01553fa}{00186}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSocket_a7bc0110f3bedbb18f26b05ece01553fa}{Socket::setTcpNoDelay}}(\textcolor{keywordtype}{bool}\ state)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00187}00187\ \ \ \textcolor{keywordtype}{int}\ set\ =\ state;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00188}00188\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classSocket_afae007041d3bb70fa141b79791019d2d}{sockfd\_}},\ IPPROTO\_TCP,\ TCP\_NODELAY,\ \&set,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00189}00189\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00191}00191\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00192}00192\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00194}00194\ \textcolor{comment}{//\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00197}\mbox{\hyperlink{classServerSocket_a2b3098589541243241ca25495155186c}{00197}}\ \mbox{\hyperlink{classServerSocket_a2b3098589541243241ca25495155186c}{ServerSocket::ServerSocket}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00198}00198\ \ \ \mbox{\hyperlink{classSocket_a1a662407744738aa56d1ccb6d7be26eb}{Socket::startup}}();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00199}00199\ \ \ \mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}}\ =\ ::socket(AF\_INET,\ SOCK\_STREAM,\ 0);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00200}00200\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00202}\mbox{\hyperlink{classServerSocket_a510674d924c2544e6b0069e39c36516b}{00202}}\ \mbox{\hyperlink{classServerSocket_a510674d924c2544e6b0069e39c36516b}{ServerSocket::\string~ServerSocket}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00203}00203\ \ \ \mbox{\hyperlink{classServerSocket_a3eac6d5571bb092622d328dbda2de2cf}{close}}();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00204}00204\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00205}00205\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00206}\mbox{\hyperlink{classServerSocket_a1e7360bc0ce72128c5439f0d245d0793}{00206}}\ \mbox{\hyperlink{classSocket}{Socket}}*\ \mbox{\hyperlink{classServerSocket_a1e7360bc0ce72128c5439f0d245d0793}{ServerSocket::createSocket}}(\mbox{\hyperlink{ccsocket_8h_aff55fe551a9992a54ec54621c524d0a4}{SOCKET}}\ sockfd)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00207}00207\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classSocket}{Socket}}(SOCK\_STREAM,\ sockfd);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00208}00208\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00211}\mbox{\hyperlink{classServerSocket_ad5281fe6c005bca007a9a758bd612481}{00211}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classServerSocket_ad5281fe6c005bca007a9a758bd612481}{ServerSocket::bind}}(\textcolor{keywordtype}{int}\ port,\ \textcolor{keywordtype}{int}\ backlog)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00212}00212\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}}\ ==\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{Socket::InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00214}00214\ \ \ \mbox{\hyperlink{ccsocket_8h_a91d11a5e66bd1e10b0e62aadb7775c9d}{SOCKADDR\_IN}}\ addr\{\};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00215}00215\ \ \ addr.sin\_family\ =\ AF\_INET;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00216}00216\ \ \ addr.sin\_port\ =\ htons(port);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00217}00217\ \ \ addr.sin\_addr.s\_addr\ =\ INADDR\_ANY;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00219}00219\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classServerSocket_ad5281fe6c005bca007a9a758bd612481}{::bind}}(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ (\mbox{\hyperlink{ccsocket_8h_a964e73b2a42e87b1e20c8ffa730952a2}{SOCKADDR}}*)\&addr,\ \textcolor{keyword}{sizeof}(addr))\ <\ 0)\ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00221}00221\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00222}00222\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00223}00223\ \ \ socklen\_t\ taille\ =\ \textcolor{keyword}{sizeof}\ addr;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00224}00224\ \ \ \textcolor{keywordflow}{if}\ (::getsockname(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ (\mbox{\hyperlink{ccsocket_8h_a964e73b2a42e87b1e20c8ffa730952a2}{SOCKADDR}}*)\&addr,\ \&taille)\ <\ 0)\ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00225}00225\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00227}00227\ \ \ \textcolor{comment}{//\ le\ serveur\ se\ met\ en\ attente\ sur\ le\ socket\ d'ecoute}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00228}00228\ \ \ \textcolor{comment}{//\ listen\ s'applique\ seulement\ aux\ sockets\ de\ type\ SOCK\_STREAM\ ou\ SOCK\_SEQPACKET.}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00229}00229\ \ \ \textcolor{keywordflow}{if}\ (::listen(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ backlog)\ <\ 0)\ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00230}00230\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00231}00231\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00232}00232\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00233}00233\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00234}\mbox{\hyperlink{classServerSocket_a3eac6d5571bb092622d328dbda2de2cf}{00234}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classServerSocket_a3eac6d5571bb092622d328dbda2de2cf}{ServerSocket::close}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00235}00235\ \ \ \textcolor{keywordtype}{int}\ stat\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00236}00236\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}}\ !=\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00237}00237\ \ \ \ \ \textcolor{comment}{//\ ::shutdown(sockfd,\ SHUT\_RDWR);}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00238}00238\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00239}00239\ \ \ \ \ ::closesocket(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00240}00240\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00241}00241\ \ \ \ \ \mbox{\hyperlink{classServerSocket_a3eac6d5571bb092622d328dbda2de2cf}{::close}}(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00242}00242\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00243}00243\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00244}00244\ \ \ \mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}}\ =\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00245}00245\ \ \ \textcolor{keywordflow}{return}\ stat;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00246}00246\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00249}\mbox{\hyperlink{classServerSocket_accc3d56d42aa50a5f3c920cf0b26959b}{00249}}\ \mbox{\hyperlink{classSocket}{Socket}}*\ \mbox{\hyperlink{classServerSocket_accc3d56d42aa50a5f3c920cf0b26959b}{ServerSocket::accept}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00250}00250\ \ \ \mbox{\hyperlink{ccsocket_8h_aff55fe551a9992a54ec54621c524d0a4}{SOCKET}}\ sock\_com\{\};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00251}00251\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00252}00252\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ ||\ defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00253}00253\ \ \ \mbox{\hyperlink{ccsocket_8h_a91d11a5e66bd1e10b0e62aadb7775c9d}{SOCKADDR\_IN}}\ addr\_com;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00254}00254\ \ \ \textcolor{keywordtype}{int}\ sizeofaddr\_\ =\ \textcolor{keyword}{sizeof}(addr\_com);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00255}00255\ \ \ sock\_com\ =\ \mbox{\hyperlink{classServerSocket_accc3d56d42aa50a5f3c920cf0b26959b}{::accept}}(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ (\mbox{\hyperlink{ccsocket_8h_a964e73b2a42e87b1e20c8ffa730952a2}{SOCKADDR}}*)\&addr\_com,\ \&sizeofaddr\_);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00256}00256\ \ \ \textcolor{keywordflow}{if}\ (sock\_com\ ==\ \mbox{\hyperlink{ccsocket_8h_a26769957ec1a2beaf223f33b66ee64ab}{INVALID\_SOCKET}})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00257}00257\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00258}00258\ \ \ \textcolor{comment}{//\ cf.\ man\ -\/s\ 3n\ accept,\ EINTR\ et\ EWOULBLOCK\ ne\ sont\ pas\ geres!}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00259}00259\ \ \ \textcolor{keywordflow}{if}\ ((sock\_com\ =\ \mbox{\hyperlink{classServerSocket_accc3d56d42aa50a5f3c920cf0b26959b}{::accept}}(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ NULL,\ NULL))\ <\ 0)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00260}00260\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00261}00261\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classServerSocket_a1e7360bc0ce72128c5439f0d245d0793}{createSocket}}(sock\_com);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00262}00262\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00263}00263\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00264}00264\ \textcolor{preprocessor}{\#if\ !defined(\_WIN32)\ \&\&\ !defined(\_WIN64)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00265}00265\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00266}\mbox{\hyperlink{classServerSocket_ab34154bc6114c638ae02f5e018121099}{00266}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classServerSocket_ab34154bc6114c638ae02f5e018121099}{ServerSocket::setReceiveBufferSize}}(\textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00267}00267\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ SOL\_SOCKET,\ SO\_RCVBUF,\ \&size,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00268}00268\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00269}00269\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00270}00270\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00271}\mbox{\hyperlink{classServerSocket_ae60d7cc31ad535e5d3cac42e38b8ec98}{00271}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classServerSocket_ae60d7cc31ad535e5d3cac42e38b8ec98}{ServerSocket::setReuseAddress}}(\textcolor{keywordtype}{bool}\ state)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00272}00272\ \ \ \textcolor{keywordtype}{int}\ set\ =\ state;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00273}00273\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ SOL\_SOCKET,\ SO\_REUSEADDR,\ \&set,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00274}00274\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00275}00275\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00277}\mbox{\hyperlink{classServerSocket_aedb9144c9c375fcb14ac47bcb9d2eb17}{00277}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classServerSocket_aedb9144c9c375fcb14ac47bcb9d2eb17}{ServerSocket::setSoTimeout}}(\textcolor{keywordtype}{int}\ timeout)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00278}00278\ \ \ \textcolor{keyword}{struct\ }timeval\ tv;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00279}00279\ \ \ tv.tv\_sec\ =\ timeout\ /\ 1000;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ms\ to\ seconds}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00280}00280\ \ \ tv.tv\_usec\ =\ (timeout\ \%\ 1000)\ *\ 1000;\ \ \ \textcolor{comment}{//\ ms\ to\ microseconds}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00281}00281\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ SOL\_SOCKET,\ SO\_RCVTIMEO,\ \&tv,\ \textcolor{keyword}{sizeof}(tv));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00282}00282\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00283}00283\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00284}00284\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00285}\mbox{\hyperlink{classServerSocket_a9e5e1ee852ba26156c757a0086b780fe}{00285}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classServerSocket_a9e5e1ee852ba26156c757a0086b780fe}{ServerSocket::setTcpNoDelay}}(\textcolor{keywordtype}{bool}\ state)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00286}00286\ \ \ \textcolor{comment}{//\ turn\ off\ TCP\ coalescence\ for\ INET\ sockets\ (useful\ in\ some\ cases\ to\ avoid\ delays)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00287}00287\ \ \ \textcolor{keywordtype}{int}\ set\ =\ state;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00288}00288\ \ \ return\ ::setsockopt(\mbox{\hyperlink{classServerSocket_ac83ceafd3f8f2242c68e398901be12bd}{sockfd\_}},\ IPPROTO\_TCP,\ TCP\_NODELAY,\ (\textcolor{keywordtype}{char}*)\&set,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00289}00289\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00291}00291\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00292}00292\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00293}00293\ \textcolor{comment}{//\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/\ -\/}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00295}00295\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00296}\mbox{\hyperlink{structInputBuffer}{00296}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structInputBuffer}{InputBuffer}}\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00297}\mbox{\hyperlink{structInputBuffer_a9409ec8e4581caa99dcac1af963349b5}{00297}}\ \ \ \mbox{\hyperlink{structInputBuffer_a9409ec8e4581caa99dcac1af963349b5}{InputBuffer}}(\textcolor{keywordtype}{size\_t}\ size)\ :}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00298}00298\ \ \ \mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{buffer}}(new\ char[size]),}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00299}00299\ \ \ \mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}}(\mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{buffer}}),}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00300}00300\ \ \ \mbox{\hyperlink{structInputBuffer_a52ba71c71b9b955b8369fc5217e3c4b6}{end}}(\mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{buffer}}\ +\ size),\ \mbox{\hyperlink{structInputBuffer_ad94b06e792363709c990e9aa78c500ec}{remaining}}(0)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00301}00301\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00302}00302\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00303}\mbox{\hyperlink{structInputBuffer_acbb3a083318ff4e73a67646dd0b8996e}{00303}}\ \ \ \mbox{\hyperlink{structInputBuffer_acbb3a083318ff4e73a67646dd0b8996e}{\string~InputBuffer}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00304}00304\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{buffer}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00305}00305\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00306}\mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{00306}}\ \ \ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{buffer}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00307}\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{00307}}\ \ \ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00308}\mbox{\hyperlink{structInputBuffer_a52ba71c71b9b955b8369fc5217e3c4b6}{00308}}\ \ \ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structInputBuffer_a52ba71c71b9b955b8369fc5217e3c4b6}{end}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00309}\mbox{\hyperlink{structInputBuffer_ad94b06e792363709c990e9aa78c500ec}{00309}}\ \ \ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ \mbox{\hyperlink{structInputBuffer_ad94b06e792363709c990e9aa78c500ec}{remaining}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00310}00310\ \};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00311}00311\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00313}\mbox{\hyperlink{classSocketBuffer_ac5989bcaf64234947934c7106af1cf38}{00313}}\ \mbox{\hyperlink{classSocketBuffer_ac5989bcaf64234947934c7106af1cf38}{SocketBuffer::SocketBuffer}}(\mbox{\hyperlink{classSocket}{Socket}}*\ sock,\ \textcolor{keywordtype}{size\_t}\ inSize,\ \textcolor{keywordtype}{size\_t}\ outSize)\ :}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00314}00314\ insize\_(inSize),}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00315}00315\ outsize\_(outSize),}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00316}00316\ insep\_(-\/1),\ \ \textcolor{comment}{//\ means\ '\(\backslash\)r'\ or\ '\(\backslash\)n'\ or\ "{}\(\backslash\)r\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00317}00317\ outsep\_(\textcolor{stringliteral}{'\(\backslash\)n'}),}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00318}00318\ sock\_(sock),}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00319}00319\ in\_(nullptr)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00320}00320\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00321}00321\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00322}00322\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00323}\mbox{\hyperlink{classSocketBuffer_a739a80a7bb5d2603d8d0d9a88293bad8}{00323}}\ \mbox{\hyperlink{classSocketBuffer_ac5989bcaf64234947934c7106af1cf38}{SocketBuffer::SocketBuffer}}(\mbox{\hyperlink{classSocket}{Socket}}\&\ sock,\ \textcolor{keywordtype}{size\_t}\ inSize,\ \textcolor{keywordtype}{size\_t}\ outSize)}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00324}00324\ :\ \mbox{\hyperlink{classSocketBuffer}{SocketBuffer}}(\&sock,\ inSize,\ outSize)\ \{\}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00326}00326\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00327}\mbox{\hyperlink{classSocketBuffer_a0ad263e938dccba0493d1d3e98f1c574}{00327}}\ \mbox{\hyperlink{classSocketBuffer_a0ad263e938dccba0493d1d3e98f1c574}{SocketBuffer::\string~SocketBuffer}}()\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00328}00328\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00329}00329\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00330}00330\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00331}00331\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00332}\mbox{\hyperlink{classSocketBuffer_aca9ca0b2defa3b9e08bbbe6abafe3f16}{00332}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSocketBuffer_aca9ca0b2defa3b9e08bbbe6abafe3f16}{SocketBuffer::setReadSeparator}}(\textcolor{keywordtype}{int}\ separ)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00333}00333\ \ \ \mbox{\hyperlink{classSocketBuffer_a9103ba29f1740eb1ef20500f3d1eeb92}{insep\_}}\ =\ separ;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00334}00334\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00335}00335\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00336}00336\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00337}\mbox{\hyperlink{classSocketBuffer_a165d87f2460de769fb09d84a46a793a4}{00337}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSocketBuffer_a165d87f2460de769fb09d84a46a793a4}{SocketBuffer::setWriteSeparator}}(\textcolor{keywordtype}{int}\ separ)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00338}00338\ \ \ \mbox{\hyperlink{classSocketBuffer_a2ce505eb4c7d94f92d910e695b327d40}{outsep\_}}\ =\ separ;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00339}00339\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00340}00340\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00341}00341\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00342}\mbox{\hyperlink{classSocketBuffer_afa3a2f239eb56c2e4fd4fa465f7fb54d}{00342}}\ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ \mbox{\hyperlink{classSocketBuffer_afa3a2f239eb56c2e4fd4fa465f7fb54d}{SocketBuffer::readLine}}(\textcolor{keywordtype}{string}\&\ str)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00343}00343\ \ \ str.clear();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00344}00344\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{Socket::InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00345}00345\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}})\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{structInputBuffer}{InputBuffer}}(\mbox{\hyperlink{classSocketBuffer_a079fdc120086897d487fd5542fe57c7e}{insize\_}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00346}00346\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00347}00347\ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00348}00348\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocketBuffer_afed3bfc9187c207578f8ffe37c811a83}{retrieveLine}}(str,\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_ad94b06e792363709c990e9aa78c500ec}{remaining}}))\ \textcolor{keywordflow}{return}\ str.length()\ +\ 1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00349}00349\ \ \ \ \ \textcolor{comment}{//\ -\/\ received\ >\ 0:\ data\ received}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00350}00350\ \ \ \ \ \textcolor{comment}{//\ -\/\ received\ =\ 0:\ nothing\ received\ (shutdown\ or\ empty\ message)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00351}00351\ \ \ \ \ \textcolor{comment}{//\ -\/\ received\ <\ 0:\ an\ error\ occurred}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00352}00352\ \ \ \ \ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ received\ =\ \mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}}-\/>\mbox{\hyperlink{classSocket_a01b463d51433a10658854446bde71c40}{receive}}(\mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}},\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a52ba71c71b9b955b8369fc5217e3c4b6}{end}}\ -\/\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00353}00353\ \ \ \ \ \textcolor{keywordflow}{if}\ (received\ <=\ 0)\ \textcolor{keywordflow}{return}\ received;\ \ \ \ \ \textcolor{comment}{//\ -\/1\ (error)\ or\ 0\ (shutdown)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00354}00354\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocketBuffer_afed3bfc9187c207578f8ffe37c811a83}{retrieveLine}}(str,\ received))\ \textcolor{keywordflow}{return}\ str.length()\ +\ 1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00355}00355\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00356}00356\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00358}00358\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00359}\mbox{\hyperlink{classSocketBuffer_afed3bfc9187c207578f8ffe37c811a83}{00359}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classSocketBuffer_afed3bfc9187c207578f8ffe37c811a83}{SocketBuffer::retrieveLine}}(\textcolor{keywordtype}{string}\&\ str,\ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ received)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00360}00360\ \ \ \textcolor{keywordflow}{if}\ (received\ <=\ 0\ ||\ in\_-\/>begin\ >\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a52ba71c71b9b955b8369fc5217e3c4b6}{end}})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00361}00361\ \ \ \ \ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}}\ =\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{buffer}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00362}00362\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00363}00363\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00364}00364\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00365}00365\ \ \ \textcolor{comment}{//\ search\ for\ separator}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00366}00366\ \ \ \textcolor{keywordtype}{char}*\ sep\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00367}00367\ \ \ \textcolor{keywordtype}{int}\ sepLen\ =\ 1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00368}00368\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00369}00369\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocketBuffer_a9103ba29f1740eb1ef20500f3d1eeb92}{insep\_}}\ <\ 0)\ \{\ \ \ \ \ \textcolor{comment}{//\ means:\ '\(\backslash\)r'\ or\ '\(\backslash\)n'\ or\ "{}\(\backslash\)r\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00370}00370\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{char}*\ p\ =\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}};\ p\ <\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}}\ +\ received;\ ++p)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00371}00371\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*p\ ==\ \textcolor{charliteral}{'\(\backslash\)n'})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00372}00372\ \ \ \ \ \ \ \ \ sep\ =\ p;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00373}00373\ \ \ \ \ \ \ \ \ sepLen\ =\ 1;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00374}00374\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00375}00375\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00376}00376\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (*p\ ==\ \textcolor{charliteral}{'\(\backslash\)r'})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00377}00377\ \ \ \ \ \ \ \ \ sep\ =\ p;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00378}00378\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p\ <\ in\_-\/>begin\ +\ received\ -\/\ 1\ \&\&\ *(p\ +\ 1)\ ==\ \textcolor{charliteral}{'\(\backslash\)n'})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00379}00379\ \ \ \ \ \ \ \ \ \ \ sepLen\ =\ 2;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00380}00380\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00381}00381\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00382}00382\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00383}00383\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00384}00384\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00385}00385\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00386}00386\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{char}*\ p\ =\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}};\ p\ <\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}}\ +\ received;\ ++p)}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00387}00387\ \ \ \ \ \textcolor{keywordflow}{if}\ (*p\ ==\ \mbox{\hyperlink{classSocketBuffer_a9103ba29f1740eb1ef20500f3d1eeb92}{insep\_}})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00388}00388\ \ \ \ \ \ \ sep\ =\ p;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00389}00389\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00390}00390\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00391}00391\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00392}00392\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00393}00393\ \ \ \textcolor{keywordflow}{if}\ (sep)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00394}00394\ \ \ \ \ str.append(\mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}},\ sep\ -\/\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00395}00395\ \ \ \ \ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_ad94b06e792363709c990e9aa78c500ec}{remaining}}\ =\ received\ -\/\ (sep\ +\ sepLen\ -\/\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00396}00396\ \ \ \ \ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}}\ =\ sep\ +\ sepLen;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00397}00397\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00398}00398\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00399}00399\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00400}00400\ \ \ \ \ str.append(\mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}},\ received);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00401}00401\ \ \ \ \ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_a2f05121c4fb8571845cc22d083c6da46}{begin}}\ =\ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_aee7a717b6cf023deabe9910410e6cfb6}{buffer}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00402}00402\ \ \ \ \ \mbox{\hyperlink{classSocketBuffer_a78504f4a49e11250977fab9fb56f387f}{in\_}}-\/>\mbox{\hyperlink{structInputBuffer_ad94b06e792363709c990e9aa78c500ec}{remaining}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00403}00403\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00404}00404\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00405}00405\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00406}00406\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00407}00407\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00408}\mbox{\hyperlink{classSocketBuffer_a96ba6ada0c8b57eacff2aa2e4e34c282}{00408}}\ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ \mbox{\hyperlink{classSocketBuffer_a96ba6ada0c8b57eacff2aa2e4e34c282}{SocketBuffer::writeLine}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\&\ str)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00409}00409\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{Socket::InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00410}00410\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00411}00411\ \ \ \textcolor{keywordtype}{size\_t}\ strlen\ =\ str.length();}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00412}00412\ \ \ \textcolor{comment}{//\ a\ negature\ value\ of\ outsep\ means\ that\ \(\backslash\)r\(\backslash\)n\ must\ be\ added}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00413}00413\ \ \ \textcolor{keywordtype}{size\_t}\ msglen\ =\ strlen\ +\ (\mbox{\hyperlink{classSocketBuffer_a2ce505eb4c7d94f92d910e695b327d40}{outsep\_}}\ <\ 0\ ?\ 2\ :\ 1);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00414}00414\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00415}00415\ \ \ \textcolor{comment}{//\ if\ msglen\ is\ not\ too\ large,\ try\ to\ write\ string\ +\ outsep\ in\ one\ block}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00416}00416\ \ \ \textcolor{keywordflow}{if}\ (msglen\ <=\ \mbox{\hyperlink{classSocketBuffer_a2e6112608ced0e269808fe454fa2ff81}{outsize\_}})\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00417}00417\ \ \ \ \ \textcolor{keywordtype}{char}*\ buf\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[msglen];}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00418}00418\ \ \ \ \ ::memcpy(buf,\ str.data(),\ strlen);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00419}00419\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00420}00420\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocketBuffer_a2ce505eb4c7d94f92d910e695b327d40}{outsep\_}}\ >=\ 0)\ buf[msglen\ -\/\ 1]\ =\ char(\mbox{\hyperlink{classSocketBuffer_a2ce505eb4c7d94f92d910e695b327d40}{outsep\_}});}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00421}00421\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00422}00422\ \ \ \ \ \ \ buf[msglen\ -\/\ 2]\ =\ \textcolor{charliteral}{'\(\backslash\)r'};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00423}00423\ \ \ \ \ \ \ buf[msglen\ -\/\ 1]\ =\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00424}00424\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00425}00425\ \ \ \ \ \textcolor{keyword}{auto}\ stat\ =\ \mbox{\hyperlink{classSocketBuffer_ad5a49e3f1f44e735eb15d1896eebf7b3}{write}}(buf,\ msglen);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00426}00426\ \ \ \ \ \textcolor{keyword}{delete}[]\ buf;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00427}00427\ \ \ \ \ \textcolor{keywordflow}{return}\ stat;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00428}00428\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00429}00429\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00430}00430\ \ \ \ \ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ sent\ =\ \mbox{\hyperlink{classSocketBuffer_ad5a49e3f1f44e735eb15d1896eebf7b3}{write}}(str.data(),\ strlen);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00431}00431\ \ \ \ \ \textcolor{keywordtype}{char}\ buf[]\ =\ \{char(\mbox{\hyperlink{classSocketBuffer_a2ce505eb4c7d94f92d910e695b327d40}{outsep\_}}),\ 0\};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00432}00432\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSocketBuffer_a2ce505eb4c7d94f92d910e695b327d40}{outsep\_}}\ >=\ 0)\ sent\ +=\ \mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}}-\/>\mbox{\hyperlink{classSocket_aadd260f15afadf0c31fa3dcf88d0ea49}{send}}(buf,\ 1);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00433}00433\ \ \ \ \ \textcolor{keywordflow}{else}\ sent\ +=\ \mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}}-\/>\mbox{\hyperlink{classSocket_aadd260f15afadf0c31fa3dcf88d0ea49}{send}}(\textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n"{}},\ 2);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00434}00434\ \ \ \ \ \textcolor{keywordflow}{return}\ sent;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00435}00435\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00436}00436\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00437}00437\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00439}\mbox{\hyperlink{classSocketBuffer_ad5a49e3f1f44e735eb15d1896eebf7b3}{00439}}\ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ \mbox{\hyperlink{classSocketBuffer_ad5a49e3f1f44e735eb15d1896eebf7b3}{SocketBuffer::write}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s,\ \textcolor{keywordtype}{size\_t}\ len)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00440}00440\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{Socket::InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00441}00441\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ begin\ =\ s;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00442}00442\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ end\ =\ s\ +\ len;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00443}00443\ \ \ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ totalSent\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00444}00444\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00445}00445\ \ \ \textcolor{keywordflow}{while}\ (begin\ <\ end)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00446}00446\ \ \ \ \ \textcolor{comment}{//\ -\/\ sent\ >\ 0:\ data\ sent}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00447}00447\ \ \ \ \ \textcolor{comment}{//\ -\/\ sent\ =\ 0:\ file\ was\ shutdown}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00448}00448\ \ \ \ \ \textcolor{comment}{//\ -\/\ sent\ <\ 0:\ an\ error\ occurred}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00449}00449\ \ \ \ \ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ sent\ =\ \mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}}-\/>\mbox{\hyperlink{classSocket_aadd260f15afadf0c31fa3dcf88d0ea49}{send}}(begin,\ end\ -\/\ begin);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00450}00450\ \ \ \ \ \textcolor{keywordflow}{if}\ (sent\ <=\ 0)\ \textcolor{keywordflow}{return}\ sent;\ \ \ \ \ \textcolor{comment}{//\ -\/1\ (error)\ or\ 0\ (shutdown)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00451}00451\ \ \ \ \ begin\ +=\ sent;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00452}00452\ \ \ \ \ totalSent\ +=\ sent;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00453}00453\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00454}00454\ \ \ \textcolor{keywordflow}{return}\ totalSent;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00455}00455\ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00456}00456\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00457}00457\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00458}\mbox{\hyperlink{classSocketBuffer_ae8a72a818dfb3a0986dc72a2e0ca5a87}{00458}}\ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ \mbox{\hyperlink{classSocketBuffer_ae8a72a818dfb3a0986dc72a2e0ca5a87}{SocketBuffer::read}}(\textcolor{keywordtype}{char}*\ s,\ \textcolor{keywordtype}{size\_t}\ len)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00459}00459\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classSocket_a9f68308228badcdd299cd83e62e36976ae3fcc87ee9b909ea92c751f70df4c9ac}{Socket::InvalidSocket}};}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00460}00460\ \ \ \textcolor{keywordtype}{char}*\ begin\ =\ s;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00461}00461\ \ \ \textcolor{keywordtype}{char}*\ end\ =\ s\ +\ len;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00462}00462\ \ \ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ totalReceived\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00463}00463\ }
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00464}00464\ \ \ \textcolor{keywordflow}{while}\ (begin\ <\ end)\ \{}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00465}00465\ \ \ \ \ \mbox{\hyperlink{ccsocket_8h_a8bc56bf597ba32a5c8d828c75b4c9566}{SOCKSIZE}}\ received\ =\ \mbox{\hyperlink{classSocketBuffer_a78f7f3187813c123cac254f6e914b9ae}{sock\_}}-\/>\mbox{\hyperlink{classSocket_a01b463d51433a10658854446bde71c40}{receive}}(begin,\ end\ -\/\ begin);}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00466}00466\ \ \ \ \ \textcolor{keywordflow}{if}\ (received\ <=\ 0)\ \textcolor{keywordflow}{return}\ received;\ \ \ \ \ \textcolor{comment}{//\ -\/1\ (error)\ or\ 0\ (shutdown)}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00467}00467\ \ \ \ \ begin\ +=\ received;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00468}00468\ \ \ \ \ totalReceived\ +=\ received;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00469}00469\ \ \ \}}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00470}00470\ \ \ \textcolor{keywordflow}{return}\ totalReceived;}
\DoxyCodeLine{\Hypertarget{ccsocket_8cpp_source_l00471}00471\ \}}

\end{DoxyCode}
